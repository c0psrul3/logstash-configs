# Normal audit-log traffic for logging command/syscall execution has an initial
# SYSCALL type, possibly an EXECVE record, followed by a CWD record, and one or
# more PATH records. These records all have the same 'audit_counter' value.

AUDITEXECVE type=%{WORD:audit_type} msg=audit\(%{NUMBER:audit_epoch}:%{NUMBER:audit_counter}\): argc=%{NUMBER:exec_arg_count} a0=\"%{NOTSPACE:exec_command}\"%{GREEDYDATA:exec_arguments}
AUDITSYSCALL type=%{WORD:audit_type} msg=audit\(%{NUMBER:audit_epoch}:%{NUMBER:audit_counter}\): arch=%{NOTSPACE} syscall=%{NUMBER:syscall_number} success=(?<syscall_sucess>(yes|no)) exit=%{NUMBER:syscall_exit_code} %{GREEDYDATA:syscall_arguments} items=%{NUMBER:syscall_path_records} ppid=%{NUMBER:syscall_parent_pid} pid=%{NUMBER:syscall_pid} auid=%{NUMBER:uid_audit} uid=%{NUMBER:running_uid} gid=%{NUMBER:group_id} euid=%{NUMBER:uid_effective} suid=%{NUMBER:uid_set} fsuid=%{NUMBER:uid_fs} egid=%{NUMBER:gid_effective} sgid=%{NUMBER:gid_set} fsgid=%{NUMBER:gid_fs} tty=%{NOTSPACE:tty} ses=%{NUMBER:session_id} comm=\"%{GREEDYDATA:command}\" exe=\"%{GREEDYDATA:exec_file}\" key=\"%{GREEDYDATA:audit_rule}\"
AUDITCWD type=%{WORD:audit_type} msg=audit\(%{NUMBER:audit_epoch}:%{NUMBER:audit_counter}\):%{SPACE}cwd=\"%{GREEDYDATA:current_working_directory}\"
AUDITPATHLONG type=%{WORD:audit_type} msg=audit\(%{NUMBER:audit_epoch}:%{NUMBER:audit_counter}\):%{SPACE}item=%{NUMBER:path_number} name=(\"%{GREEDYDATA:path_audit}\"|\(%{WORD:path_audit}\)) inode=%{NUMBER:inode_number} dev=%{NOTSPACE:device} mode=%{NUMBER:inode_mode} ouid=%{NUMBER:owner_uid} ogid=%{NUMBER:owner_gid}
AUDITPATHSHORT type=%{WORD:audit_type} msg=audit\(%{NUMBER:audit_epoch}:%{NUMBER:audit_counter}\):%{SPACE}item=%{NUMBER:path_number} name=(\"%{GREEDYDATA:path_audit}\"|\(%{WORD:path_audit}\))
AUDITCONFIG type=%{WORD:audit_type} msg=audit\(%{NUMBER:audit_epoch}:%{NUMBER:audit_counter}\):%{SPACE}auid=%{NUMBER:uid_audit} ses=%{NUMBER:new_ses} op=\"%{GREEDYDATA:audit_operation}\" path=\"%{GREEDYDATA:path_audit}\" key=\"%{GREEDYDATA:audit_rule}\"

# Audit logs generated by PAM, which captures a lot of the audit chain. For a
# good rundown, see http://people.redhat.com/sgrubb/audit/user-login-lifecycle.txt
AUDITPAMLOGIN type=%{WORD:audit_type} msg=audit\(%{NUMBER:audit_epoch}:%{NUMBER:audit_counter}\): pid=%{NUMBER:login_pid} uid=%{NUMBER} auid=%{NUMBER:uid_audit} ses=%{NUMBER:new_ses} msg='op=%{NOTSPACE:pam_operation} ((acct=\"%{GREEDYDATA:acct_audit}\")|(id=%{NUMBER:acct_uid})|acct=%{BASE16NUM:acct_audit}) exe=\"%{GREEDYDATA:exec_command}\" hostname=%{NOTSPACE:login_hostname} addr=%{NOTSPACE:login_addr} terminal=%{NOTSPACE} res=%{NOTSPACE:login_result}'

